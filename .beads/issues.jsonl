{"id":"get-harness-0ta","title":"Add HarnessKind::ALL and Harness constructors","description":"## Context\nPhase 1 of Harness API refactor. Adds new construction and discovery methods without changing existing API.\n\n## Key Changes\n- `src/types.rs` - Add `impl HarnessKind { pub const ALL: \u0026'static [Self] = \u0026[...]; }`\n- `src/harness/mod.rs` - Add `Harness::new(kind) -\u003e Self`\n- `src/harness/mod.rs` - Add `Harness::is_installed(\u0026self) -\u003e bool`\n- `src/harness/mod.rs` - Add `Harness::installed() -\u003e Result\u003cVec\u003cHarness\u003e\u003e`\n\n## Patterns to Follow\n- See `EnvValue::plain()` at `types.rs:208-211` for constructor pattern\n- See `Harness::locate()` at `mod.rs:30-42` for dispatch pattern\n- Use `#[must_use]` on constructors\n\n## Success Criteria\n- [ ] `cargo build` passes\n- [ ] `cargo test harness::` passes\n- [ ] `cargo clippy --all-targets -- -D warnings` clean\n- [ ] New methods have doc comments with examples\n\n## References\n- Full plan: `.beads/artifacts/get-harness-gye/plan.md`\n- Research: `.beads/artifacts/get-harness-gye/research.md`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T11:17:38.461205Z","updated_at":"2025-12-26T11:22:58.228366Z","closed_at":"2025-12-26T11:22:58.228366Z","close_reason":"All Phase 1 requirements implemented: HarnessKind::ALL, Harness::new(), is_installed(), installed(). Coach approved. Build/test/clippy all pass."}
{"id":"get-harness-10b","title":"Implement skills() for Claude Code","description":"Implement skills directory resource for Claude Code.\n\n## Paths\n- Global: ~/.claude/skills/\n- Project: .claude/skills/\n\n## Structure\nEach skill is a directory containing SKILL.md:\n```\nskills/\n  my-skill/\n    SKILL.md\n```\n\n## API\n```rust\nfn skills(\u0026self) -\u003e DirectoryResource {\n    DirectoryResource {\n        global_path: Some(\"~/.claude/skills\"),\n        project_path: Some(\".claude/skills\"),\n        structure: DirectoryStructure::NestedWithMarker(\"SKILL.md\"),\n    }\n}\n```\n\n## Files\n- src/harness/claude_code.rs\n\n## Acceptance Criteria\n- [ ] Return correct DirectoryResource\n- [ ] Handle missing directories gracefully\n- [ ] Unit test","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:37:47.500375Z","updated_at":"2025-12-26T09:37:47.500375Z","dependencies":[{"issue_id":"get-harness-10b","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:40.518708Z","created_by":"daemon"}]}
{"id":"get-harness-1zu","title":"Create harness specification document for contributors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T08:50:29.95978Z","updated_at":"2025-12-26T08:55:50.107296Z","closed_at":"2025-12-26T08:55:50.107296Z","close_reason":"Implemented rules_path and HARNESS_SPEC.md"}
{"id":"get-harness-4ow","title":"Implement MCP to_native converter for Goose","description":"Implement mcp_to_native() for Goose. Uses type: stdio/sse/streamable_http, cmd not command, envs not env, uri not url, timeout in seconds not ms. Requires name and description fields.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:36:27.625644Z","updated_at":"2025-12-26T09:36:27.625644Z","dependencies":[{"issue_id":"get-harness-4ow","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:34.397827Z","created_by":"daemon"}]}
{"id":"get-harness-54p","title":"Implement mcp_from_native parser for Claude Code","description":"Parse Claude Code's native MCP format from ~/.claude.json and .mcp.json into normalized McpServer types.\n\n## Input Format (Claude Code)\n```json\n{\n  \"mcpServers\": {\n    \"server-name\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\"],\n      \"env\": { \"KEY\": \"value\" }\n    }\n  }\n}\n```\n\n## Output\nVec\u003cMcpServer\u003e with normalized types\n\n## Files\n- src/harness/claude_code.rs\n\n## Acceptance Criteria\n- [ ] Parse stdio servers (command + args)\n- [ ] Parse SSE servers (type: sse)\n- [ ] Parse HTTP servers (type: http)\n- [ ] Handle env variable syntax (${VAR})\n- [ ] Unit tests for each server type","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:37:28.153559Z","updated_at":"2025-12-26T09:37:28.153559Z","dependencies":[{"issue_id":"get-harness-54p","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:37.334257Z","created_by":"daemon"}]}
{"id":"get-harness-6m7","title":"Define McpCapabilities struct","description":"Define the McpCapabilities struct that describes what MCP features each harness supports.\n\n## McpCapabilities Struct\n\n```rust\n#[derive(Debug, Clone, PartialEq, Eq)]\npub struct McpCapabilities {\n    /// Supports local stdio servers\n    pub stdio: bool,\n    \n    /// Supports SSE remote servers\n    pub sse: bool,\n    \n    /// Supports HTTP/Streamable HTTP remote servers\n    pub http: bool,\n    \n    /// Supports OAuth for remote servers\n    pub oauth: bool,\n    \n    /// Supports per-server timeout configuration\n    pub timeout: bool,\n    \n    /// Supports enable/disable toggle\n    pub toggle: bool,\n    \n    /// Supports custom headers for remote servers\n    pub headers: bool,\n    \n    /// Supports working directory (cwd) for stdio\n    pub cwd: bool,\n}\n```\n\n## Implementation per Harness\n\n```rust\nimpl Harness {\n    pub fn mcp_capabilities(\u0026self) -\u003e McpCapabilities {\n        match self.kind {\n            HarnessKind::ClaudeCode =\u003e McpCapabilities {\n                stdio: true,\n                sse: true,\n                http: true,\n                oauth: false,\n                timeout: false,\n                toggle: false,\n                headers: true,\n                cwd: false,\n            },\n            HarnessKind::OpenCode =\u003e McpCapabilities {\n                stdio: true,\n                sse: false,  // Uses 'remote' type\n                http: true,\n                oauth: true,\n                timeout: true,\n                toggle: true,\n                headers: true,\n                cwd: false,\n            },\n            HarnessKind::Goose =\u003e McpCapabilities {\n                stdio: true,\n                sse: true,\n                http: true,  // streamable_http\n                oauth: false,\n                timeout: true,  // In seconds, not ms\n                toggle: true,\n                headers: true,  // Only for streamable_http\n                cwd: false,\n            },\n        }\n    }\n    \n    /// Check if a specific server type is supported\n    pub fn supports_mcp_server(\u0026self, server: \u0026McpServer) -\u003e bool {\n        let caps = self.mcp_capabilities();\n        match server {\n            McpServer::Stdio(_) =\u003e caps.stdio,\n            McpServer::Sse(_) =\u003e caps.sse,\n            McpServer::Http(_) =\u003e caps.http,\n        }\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Capabilities accurately reflect each harness's features\n- [ ] supports_mcp_server() helper works correctly\n- [ ] Doc comments explain each capability","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:35:25.546606Z","updated_at":"2025-12-26T09:35:25.546606Z","dependencies":[{"issue_id":"get-harness-6m7","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:31.370192Z","created_by":"daemon"}]}
{"id":"get-harness-6or","title":"Define EnvValue type for environment variable handling","description":"Define the EnvValue type that handles environment variable references with harness-specific syntax.\n\n## Problem\nDifferent harnesses use different syntax for env var references:\n- Claude Code: \\${VAR}\n- OpenCode: {env:VAR}\n- Goose: Uses env_keys array, plain values\n\n## EnvValue Type\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize, PartialEq, Eq)]\n#[serde(untagged)]\npub enum EnvValue {\n    /// Plain string value\n    Plain(String),\n    /// Reference to environment variable\n    EnvRef { env: String },\n}\n\nimpl EnvValue {\n    /// Create a plain string value\n    pub fn plain(s: impl Into\u003cString\u003e) -\u003e Self {\n        Self::Plain(s.into())\n    }\n    \n    /// Create an environment variable reference\n    pub fn env(var: impl Into\u003cString\u003e) -\u003e Self {\n        Self::EnvRef { env: var.into() }\n    }\n    \n    /// Convert to harness-specific string format\n    pub fn to_native(\u0026self, kind: HarnessKind) -\u003e String {\n        match (self, kind) {\n            (Self::Plain(s), _) =\u003e s.clone(),\n            (Self::EnvRef { env }, HarnessKind::ClaudeCode) =\u003e format!(\"\\${{{}}}}\", env),\n            (Self::EnvRef { env }, HarnessKind::OpenCode) =\u003e format!(\"{{env:{}}}\", env),\n            (Self::EnvRef { env }, HarnessKind::Goose) =\u003e {\n                // Goose resolves at runtime, return empty or resolved\n                std::env::var(env).unwrap_or_default()\n            }\n        }\n    }\n    \n    /// Parse from harness-specific string format\n    pub fn from_native(s: \u0026str, kind: HarnessKind) -\u003e Self {\n        // Parse \\${VAR} or {env:VAR} patterns\n        // Return Plain if no pattern matched\n    }\n    \n    /// Resolve the value, looking up env vars if needed\n    pub fn resolve(\u0026self) -\u003e Option\u003cString\u003e {\n        match self {\n            Self::Plain(s) =\u003e Some(s.clone()),\n            Self::EnvRef { env } =\u003e std::env::var(env).ok(),\n        }\n    }\n}\n```\n\n## Usage Example\n\n```rust\nlet api_key = EnvValue::env(\"MY_API_KEY\");\nlet native = api_key.to_native(HarnessKind::ClaudeCode);\n// Returns: \"\\${MY_API_KEY}\"\n\nlet native = api_key.to_native(HarnessKind::OpenCode);\n// Returns: \"{env:MY_API_KEY}\"\n```\n\n## Acceptance Criteria\n- [ ] Supports plain strings and env references\n- [ ] Converts to all three harness formats\n- [ ] Parses from all three harness formats\n- [ ] Serde untagged works correctly\n- [ ] Unit tests for all conversions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T09:35:05.326851Z","updated_at":"2025-12-26T10:41:21.99846Z","closed_at":"2025-12-26T10:41:21.99846Z","close_reason":"EnvValue type implemented with full test coverage","dependencies":[{"issue_id":"get-harness-6or","depends_on_id":"get-harness-p4w","type":"blocks","created_at":"2025-12-26T09:40:31.21113Z","created_by":"daemon"}]}
{"id":"get-harness-7mp","title":"Epic: API Refactor for Multi-Harness Resource Management","description":"Complete API refactor to properly support MCP, skills, commands, plugins, and rules across Claude Code, OpenCode, and Goose harnesses.\n\n## Goals\n- Distinguish between directory-based resources (skills, commands, plugins) and config-embedded resources (MCP)\n- Provide normalized types with harness-specific converters\n- Support environment variable references with harness-specific syntax\n- Capture structural differences (e.g., skill vs skills, singular vs nested directories)\n- Include exists field for installation checking\n\n## Key Design Decisions\n- Use Result\u003cOption\u003cResource\u003e\u003e pattern: Err=system error, None=unsupported, Some=supported\n- Enum + Match wrapper for Harness (Option 1 with enhancements)\n- Normalized MCP types with to_native/from_native converters\n- EnvValue type for  vs {env:VAR} syntax differences\n\n## Harnesses\n- Claude Code: ~/.claude/, .claude/\n- OpenCode: ~/.config/opencode/, .opencode/\n- Goose: ~/.config/goose/, .goose/\n\n## Research Completed\n- MCP schemas verified for all harnesses\n- Skills paths verified (skill vs skills, nested structure)\n- Plugins vs MCP distinction clarified for OpenCode","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-26T09:33:48.868112Z","updated_at":"2025-12-26T09:33:48.868112Z"}
{"id":"get-harness-84c","title":"Update HARNESS_SPEC.md with corrected paths","description":"Update HARNESS_SPEC.md to fix errors discovered during research.\n\n## Corrections Needed\n\n### OpenCode\n- MCP is NOT in plugin/ directory\n- MCP is in opencode.json under 'mcp' key\n- Plugin directory is for JS/TS plugins (different from MCP!)\n- Use singular 'skill' and 'command' not plurals\n\n### Claude Code\n- Add skills support (was missing)\n- Add global rules support (~/.claude/CLAUDE.md)\n\n### Goose\n- Add skills support (was missing)\n- Verify extensions key for MCP (not mcp_servers)\n\n## Files\n- HARNESS_SPEC.md","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:40:06.936941Z","updated_at":"2025-12-26T09:40:06.936941Z"}
{"id":"get-harness-bhv","title":"Cross-platform harness path discovery for CLI tools","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T07:27:08.191598Z","updated_at":"2025-12-26T08:26:20.669033Z","closed_at":"2025-12-26T08:26:20.669033Z","close_reason":"All harnesses implemented: Claude Code, OpenCode, Goose"}
{"id":"get-harness-bhv.1","title":"Define core types and error handling","description":"Define HarnessKind, Scope, PathType enums and Error type with thiserror. Foundational types for all harness implementations.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-26T07:27:19.676235Z","updated_at":"2025-12-26T07:41:04.485069Z","closed_at":"2025-12-26T07:41:04.485069Z","close_reason":"Phase 1 complete - core types and error handling implemented, tests passing","dependencies":[{"issue_id":"get-harness-bhv.1","depends_on_id":"get-harness-bhv","type":"parent-child","created_at":"2025-12-26T07:27:19.678115Z","created_by":"daemon"}]}
{"id":"get-harness-bhv.2","title":"Implement platform-specific path resolution","description":"Platform-specific path resolution using cfg attributes. Support macOS, Linux, Windows with XDG compliance.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-26T07:27:23.463777Z","updated_at":"2025-12-26T08:10:34.262194Z","closed_at":"2025-12-26T08:10:34.262194Z","close_reason":"Implemented platform-specific path resolution with macOS, Linux (XDG), and Windows support. All tests pass.","dependencies":[{"issue_id":"get-harness-bhv.2","depends_on_id":"get-harness-bhv","type":"parent-child","created_at":"2025-12-26T07:27:23.465648Z","created_by":"daemon"}]}
{"id":"get-harness-bhv.3","title":"Implement Claude Code harness","description":"Claude Code harness: ~/.claude/, CLAUDE_CONFIG_DIR env var, skills/commands/mcp paths.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-26T07:27:28.215099Z","updated_at":"2025-12-26T08:18:32.30642Z","closed_at":"2025-12-26T08:18:32.30642Z","close_reason":"Implemented Claude Code harness with global/project config, commands, MCP paths. 16 tests passing.","dependencies":[{"issue_id":"get-harness-bhv.3","depends_on_id":"get-harness-bhv","type":"parent-child","created_at":"2025-12-26T07:27:28.2169Z","created_by":"daemon"}]}
{"id":"get-harness-bhv.4","title":"Implement OpenCode harness","description":"OpenCode harness: ~/.config/opencode/, OPENCODE_CONFIG_DIR env var. Handle singular/plural path inconsistencies.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-26T07:27:31.795998Z","updated_at":"2025-12-26T08:25:08.448659Z","closed_at":"2025-12-26T08:25:08.448659Z","close_reason":"Implemented with full path resolution and tests","dependencies":[{"issue_id":"get-harness-bhv.4","depends_on_id":"get-harness-bhv","type":"parent-child","created_at":"2025-12-26T07:27:31.797424Z","created_by":"daemon"}]}
{"id":"get-harness-bhv.5","title":"Implement Goose harness","description":"Goose harness: platform-specific paths (Application Support on macOS), GOOSE_CONFIG_DIR env var. No skills dir (MCP in config).","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-26T07:27:35.801885Z","updated_at":"2025-12-26T08:25:08.45022Z","closed_at":"2025-12-26T08:25:08.45022Z","close_reason":"Implemented with full path resolution and tests","dependencies":[{"issue_id":"get-harness-bhv.5","depends_on_id":"get-harness-bhv","type":"parent-child","created_at":"2025-12-26T07:27:35.803713Z","created_by":"daemon"}]}
{"id":"get-harness-bqr","title":"Implement MCP to_native converter for Claude Code","description":"Implement the mcp_to_native() converter for Claude Code harness.\n\n## Claude Code MCP Format\n\n### Stdio Server\n```json\n{\n  \"server-name\": {\n    \"command\": \"node\",\n    \"args\": [\"/path/to/server.js\"],\n    \"env\": {\n      \"API_KEY\": \"\\${MY_API_KEY}\"\n    }\n  }\n}\n```\n\n### SSE Server\n```json\n{\n  \"server-name\": {\n    \"type\": \"sse\",\n    \"url\": \"https://example.com/sse\"\n  }\n}\n```\n\n### HTTP Server\n```json\n{\n  \"server-name\": {\n    \"type\": \"http\",\n    \"url\": \"https://api.example.com/mcp\",\n    \"headers\": {\n      \"Authorization\": \"Bearer \\${TOKEN}\"\n    }\n  }\n}\n```\n\n## Key Differences\n- Stdio is default (no type field needed)\n- Uses \\${VAR} for env var substitution\n- No enabled/disabled toggle\n- No timeout field\n- env not environment\n\n## Implementation\n\n```rust\nfn claude_code_mcp_to_native(name: \u0026str, server: \u0026McpServer) -\u003e serde_json::Value {\n    match server {\n        McpServer::Stdio(s) =\u003e {\n            let mut obj = json!({\n                \"command\": s.command,\n            });\n            if !s.args.is_empty() {\n                obj[\"args\"] = json!(s.args);\n            }\n            if !s.env.is_empty() {\n                let env: HashMap\u003cString, String\u003e = s.env.iter()\n                    .map(|(k, v)| (k.clone(), v.to_native(HarnessKind::ClaudeCode)))\n                    .collect();\n                obj[\"env\"] = json!(env);\n            }\n            obj\n        }\n        McpServer::Sse(s) =\u003e json!({\n            \"type\": \"sse\",\n            \"url\": s.url,\n        }),\n        McpServer::Http(s) =\u003e {\n            let mut obj = json!({\n                \"type\": \"http\",\n                \"url\": s.url,\n            });\n            if !s.headers.is_empty() {\n                let headers: HashMap\u003cString, String\u003e = s.headers.iter()\n                    .map(|(k, v)| (k.clone(), v.to_native(HarnessKind::ClaudeCode)))\n                    .collect();\n                obj[\"headers\"] = json!(headers);\n            }\n            obj\n        }\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Correctly converts all three transport types\n- [ ] Uses \\${VAR} syntax for env values\n- [ ] Omits optional fields when empty\n- [ ] Unit tests cover all cases","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:36:12.592908Z","updated_at":"2025-12-26T09:36:12.592908Z","dependencies":[{"issue_id":"get-harness-bqr","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:34.25363Z","created_by":"daemon"}]}
{"id":"get-harness-ci1","title":"Add API documentation and examples","description":"Add comprehensive API documentation with examples.\n\n## Sections Needed\n- Getting Started (Installation, Basic usage, Detecting harness)\n- Resource Types (DirectoryResource, ConfigResource examples)\n- MCP (Normalized types, Converting to/from native formats)\n- Per-Resource Documentation\n\n## Files\n- README.md (update)\n- src/lib.rs (doc comments)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-26T09:40:10.644546Z","updated_at":"2025-12-26T09:40:10.644546Z"}
{"id":"get-harness-d6a","title":"Refactor resource methods to return structured types","description":"## Context\nPhase 2 of Harness API refactor. Changes all *_path() methods to return Result\u003cOption\u003cDirectoryResource|ConfigResource\u003e\u003e.\n\n## Key Changes\n- `src/harness/mod.rs` - Rename `skills_path()` -\u003e `skills()`, return `Result\u003cOption\u003cDirectoryResource\u003e\u003e`\n- `src/harness/mod.rs` - Rename `commands_path()` -\u003e `commands()`, return `Result\u003cOption\u003cDirectoryResource\u003e\u003e`\n- `src/harness/mod.rs` - Rename `config_path()` -\u003e `config()`, return `Result\u003cPathBuf\u003e`\n- `src/harness/mod.rs` - Rename `mcp_path()` -\u003e `mcp()`, return `Result\u003cOption\u003cConfigResource\u003e\u003e`\n- `src/harness/mod.rs` - Rename `rules_path()` -\u003e `rules()`, return `Result\u003cOption\u003cDirectoryResource\u003e\u003e`\n- `src/harness/mod.rs` - Add `plugins()` -\u003e `Result\u003cOption\u003cDirectoryResource\u003e\u003e` (OpenCode only)\n- `src/harness/mod.rs` - Add `agents()` -\u003e `Result\u003cOption\u003cDirectoryResource\u003e\u003e` (OpenCode only)\n\n## Error Handling Pattern\n- `Err(...)` = system error (can't find home dir)\n- `Ok(None)` = feature not supported by this harness\n- `Ok(Some(resource))` = supported, check `resource.exists`\n\n## Patterns to Follow\n- Take `scope: \u0026Scope` (by reference)\n- Use `DirectoryStructure::Flat` for commands, `Nested` for skills\n- Goose commands returns `Ok(None)` - no dedicated commands dir\n\n## Success Criteria\n- [ ] All *_path() methods renamed and refactored\n- [ ] `plugins()` and `agents()` added\n- [ ] `cargo build` passes\n- [ ] `cargo clippy --all-targets -- -D warnings` clean\n\n## References\n- Full plan: `.beads/artifacts/get-harness-gye/plan.md` (Phase 2 section)\n- DirectoryResource: `src/types.rs:127-137`\n- ConfigResource: `src/types.rs:143-155`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T11:17:46.100156Z","updated_at":"2025-12-26T11:50:13.052616Z","closed_at":"2025-12-26T11:50:13.052616Z","close_reason":"All Phase 2 requirements implemented: skills, commands, config, mcp, rules refactored to return Result\u003cOption\u003cResource\u003e\u003e; plugins() and agents() added. Build/clippy/tests all pass.","dependencies":[{"issue_id":"get-harness-d6a","depends_on_id":"get-harness-0ta","type":"blocks","created_at":"2025-12-26T11:17:59.723078Z","created_by":"daemon"}]}
{"id":"get-harness-f5x","title":"Implement rules() for all harnesses","description":"Implement rules file resource for all harnesses.\n\n## Claude Code\n- Global: ~/.claude/CLAUDE.md\n- Project: CLAUDE.md (root) or .claude/CLAUDE.md\n\n## OpenCode\n- Global: ~/.config/opencode/AGENTS.md (verify exact name)\n- Project: AGENTS.md (root) or .opencode/AGENTS.md\n\n## Goose\n- Global: ~/.config/goose/instructions.md (verify)\n- Project: .goose/instructions.md\n\n## Files\n- src/harness/claude_code.rs\n- src/harness/opencode.rs\n- src/harness/goose.rs\n\n## Acceptance Criteria\n- [ ] Implement for Claude Code\n- [ ] Implement for OpenCode\n- [ ] Implement for Goose\n- [ ] Handle multiple possible locations\n- [ ] Unit tests","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:38:18.698605Z","updated_at":"2025-12-26T09:38:18.698605Z","dependencies":[{"issue_id":"get-harness-f5x","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:43.663944Z","created_by":"daemon"}]}
{"id":"get-harness-frk","title":"Implement rules_path() for all harnesses","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-26T08:50:23.854033Z","updated_at":"2025-12-26T08:55:50.105862Z","closed_at":"2025-12-26T08:55:50.105862Z","close_reason":"Implemented rules_path and HARNESS_SPEC.md"}
{"id":"get-harness-g09","title":"Implement agents() for OpenCode","description":"Implement agents directory resource for OpenCode ONLY.\n\n## Paths\n- Global: ~/.config/opencode/agent/\n- Project: .opencode/agent/\n\n## Structure\nEach agent is a YAML/JSON file defining an agent profile.\n\n## API\n```rust\n// Only OpenCode has agents\nfn agents(\u0026self) -\u003e Option\u003cDirectoryResource\u003e {\n    Some(DirectoryResource {\n        global_path: Some(\"~/.config/opencode/agent\"),\n        project_path: Some(\".opencode/agent\"),\n        structure: DirectoryStructure::FlatFiles(\"*.{yaml,json}\"),\n    })\n}\n```\n\n## Files\n- src/harness/opencode.rs\n- src/harness/claude_code.rs (return None)\n- src/harness/goose.rs (return None)\n\n## Acceptance Criteria\n- [ ] Implement for OpenCode\n- [ ] Return None for Claude Code\n- [ ] Return None for Goose\n- [ ] Unit test","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:38:36.29894Z","updated_at":"2025-12-26T09:38:36.29894Z","dependencies":[{"issue_id":"get-harness-g09","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:43.844315Z","created_by":"daemon"}]}
{"id":"get-harness-gye","title":"Refactor Harness struct with enhanced API","description":"Refactor the Harness struct to use the new type system with enhanced methods.\n\n## Changes to HarnessKind\n\n```rust\npub enum HarnessKind {\n    ClaudeCode,\n    OpenCode,\n    Goose,\n}\n\nimpl HarnessKind {\n    /// All known harness types\n    pub const ALL: \u0026'static [HarnessKind] = \u0026[\n        HarnessKind::ClaudeCode,\n        HarnessKind::OpenCode,\n        HarnessKind::Goose,\n    ];\n}\n```\n\n## New Harness Struct\n\n```rust\npub struct Harness {\n    kind: HarnessKind,\n}\n\nimpl Harness {\n    pub fn new(kind: HarnessKind) -\u003e Self;\n    pub fn kind(\u0026self) -\u003e HarnessKind;\n    \n    /// Returns all harnesses installed on this system\n    pub fn installed() -\u003e Vec\u003cHarness\u003e;\n    \n    /// Check if this harness is installed\n    pub fn is_installed(\u0026self) -\u003e bool;\n    \n    // Resource methods - all return Result\u003cOption\u003c_\u003e\u003e\n    pub fn skills(\u0026self, scope: \u0026Scope) -\u003e Result\u003cOption\u003cDirectoryResource\u003e\u003e;\n    pub fn commands(\u0026self, scope: \u0026Scope) -\u003e Result\u003cOption\u003cDirectoryResource\u003e\u003e;\n    pub fn plugins(\u0026self, scope: \u0026Scope) -\u003e Result\u003cOption\u003cDirectoryResource\u003e\u003e;\n    pub fn mcp(\u0026self, scope: \u0026Scope) -\u003e Result\u003cOption\u003cConfigResource\u003e\u003e;\n    pub fn rules(\u0026self, scope: \u0026Scope) -\u003e Result\u003cOption\u003cDirectoryResource\u003e\u003e;\n    pub fn agents(\u0026self, scope: \u0026Scope) -\u003e Result\u003cOption\u003cDirectoryResource\u003e\u003e;\n    pub fn config(\u0026self, scope: \u0026Scope) -\u003e Result\u003cPathBuf\u003e;\n}\n```\n\n## Error Handling Pattern\n- Err(...) = system error (can't find home dir, etc.)\n- Ok(None) = feature not supported by this harness\n- Ok(Some(resource)) = supported, check resource.exists for presence\n\n## Acceptance Criteria\n- [ ] HarnessKind::ALL constant added\n- [ ] Harness::installed() method works\n- [ ] All resource methods return Result\u003cOption\u003c_\u003e\u003e\n- [ ] Existing tests updated or replaced","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T09:34:24.870898Z","updated_at":"2025-12-26T12:00:34.713894Z","closed_at":"2025-12-26T12:00:34.713894Z","close_reason":"All phases complete - HarnessKind::ALL added, all resource methods refactored to return Result\u003cOption\u003cResource\u003e\u003e, tests updated","dependencies":[{"issue_id":"get-harness-gye","depends_on_id":"get-harness-p4w","type":"blocks","created_at":"2025-12-26T09:40:31.452875Z","created_by":"daemon"},{"issue_id":"get-harness-gye","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:31.536285Z","created_by":"daemon"}]}
{"id":"get-harness-how","title":"Implement skills() for OpenCode","description":"Implement skills directory resource for OpenCode.\n\n## Paths (NOTE: singular 'skill' not 'skills')\n- Global: ~/.config/opencode/skill/\n- Project: .opencode/skill/\n\n## Structure\nEach skill is a directory containing SKILL.md:\n```\nskill/\n  my-skill/\n    SKILL.md\n```\n\n## API\n```rust\nfn skills(\u0026self) -\u003e DirectoryResource {\n    DirectoryResource {\n        global_path: Some(\"~/.config/opencode/skill\"),\n        project_path: Some(\".opencode/skill\"),\n        structure: DirectoryStructure::NestedWithMarker(\"SKILL.md\"),\n    }\n}\n```\n\n## CRITICAL\nOpenCode uses SINGULAR 'skill' directory name, not 'skills'!\n\n## Files\n- src/harness/opencode.rs\n\n## Acceptance Criteria\n- [ ] Return correct DirectoryResource with singular path\n- [ ] Unit test","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:37:53.539644Z","updated_at":"2025-12-26T09:37:53.539644Z","dependencies":[{"issue_id":"get-harness-how","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:40.589416Z","created_by":"daemon"}]}
{"id":"get-harness-ijh","title":"Implement commands() for all harnesses","description":"Implement commands directory resource for all harnesses.\n\n## Claude Code\n- Global: ~/.claude/commands/\n- Project: .claude/commands/\n- Structure: Markdown files (*.md)\n\n## OpenCode\n- Global: ~/.config/opencode/command/\n- Project: .opencode/command/\n- Structure: Markdown files (*.md)\n- NOTE: Singular 'command' not 'commands'\n\n## Goose\n- Global: ~/.config/goose/commands/ (verify)\n- Project: .goose/commands/ (verify)\n- Structure: TBD - verify from source\n\n## Files\n- src/harness/claude_code.rs\n- src/harness/opencode.rs\n- src/harness/goose.rs\n\n## Acceptance Criteria\n- [ ] Implement for Claude Code\n- [ ] Implement for OpenCode (singular path)\n- [ ] Implement for Goose (or return None if unsupported)\n- [ ] Unit tests","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:38:11.614166Z","updated_at":"2025-12-26T09:38:11.614166Z","dependencies":[{"issue_id":"get-harness-ijh","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:43.57527Z","created_by":"daemon"}]}
{"id":"get-harness-ku1","title":"Implement skills() for Goose","description":"Implement skills directory resource for Goose.\n\n## Paths\n- Global: ~/.config/goose/skills/\n- Project: .goose/skills/ (if supported)\n\n## Structure\nSkills are markdown files in the skills directory.\n\n## API\n```rust\nfn skills(\u0026self) -\u003e DirectoryResource {\n    DirectoryResource {\n        global_path: Some(\"~/.config/goose/skills\"),\n        project_path: None,  // Verify if project-level exists\n        structure: DirectoryStructure::FlatFiles(\"*.md\"),\n    }\n}\n```\n\n## Files\n- src/harness/goose.rs\n\n## Acceptance Criteria\n- [ ] Verify Goose skills structure from source\n- [ ] Return correct DirectoryResource\n- [ ] Unit test","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:37:59.138589Z","updated_at":"2025-12-26T09:37:59.138589Z","dependencies":[{"issue_id":"get-harness-ku1","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:40.663485Z","created_by":"daemon"}]}
{"id":"get-harness-l33","title":"Implement mcp_from_native parser for OpenCode","description":"Parse OpenCode's native MCP format from opencode.json mcp key into normalized McpServer types.\n\n## Input Format (OpenCode)\n```json\n{\n  \"mcp\": {\n    \"server-name\": {\n      \"type\": \"local\",\n      \"command\": [\"npx\", \"-y\", \"server\"],\n      \"environment\": { \"KEY\": \"value\" },\n      \"enabled\": true,\n      \"timeout\": 30000\n    }\n  }\n}\n```\n\n## Output\nVec\u003cMcpServer\u003e with normalized types\n\n## Files\n- src/harness/opencode.rs\n\n## Acceptance Criteria\n- [ ] Parse local servers (type: local, command as array)\n- [ ] Parse remote servers (type: remote, url)\n- [ ] Handle environment key (not env)\n- [ ] Handle {env:VAR} syntax\n- [ ] Handle oauth configuration\n- [ ] Handle timeout in milliseconds\n- [ ] Handle enabled flag (skip disabled servers)\n- [ ] Unit tests","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:37:31.877975Z","updated_at":"2025-12-26T09:37:31.877975Z","dependencies":[{"issue_id":"get-harness-l33","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:37.406761Z","created_by":"daemon"}]}
{"id":"get-harness-lid","title":"Implement mcp_from_native parser for Goose","description":"Parse Goose's native MCP format from config.yaml extensions key into normalized McpServer types.\n\n## Input Format (Goose)\n```yaml\nextensions:\n  server-name:\n    type: stdio\n    cmd: npx\n    args:\n      - -y\n      - server\n    envs:\n      KEY: value\n    timeout: 30\n```\n\n## Output\nVec\u003cMcpServer\u003e with normalized types\n\n## Files\n- src/harness/goose.rs\n\n## Acceptance Criteria\n- [ ] Parse stdio servers\n- [ ] Parse SSE servers (type: sse, uri)\n- [ ] Parse streamable_http servers\n- [ ] Handle envs key (not env)\n- [ ] Handle timeout in SECONDS (convert to ms internally)\n- [ ] Unit tests","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:37:34.615677Z","updated_at":"2025-12-26T09:37:34.615677Z","dependencies":[{"issue_id":"get-harness-lid","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:37.485136Z","created_by":"daemon"}]}
{"id":"get-harness-nfd","title":"Implement MCP to_native converter for OpenCode","description":"Implement mcp_to_native() for OpenCode. Uses type: local/remote, command as array, environment not env, supports enabled/timeout/oauth. Schema at https://opencode.ai/config.json","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:36:21.457463Z","updated_at":"2025-12-26T09:36:21.457463Z","dependencies":[{"issue_id":"get-harness-nfd","depends_on_id":"get-harness-vvg","type":"blocks","created_at":"2025-12-26T09:40:34.326936Z","created_by":"daemon"}]}
{"id":"get-harness-p4w","title":"Define core types and enums","description":"Define the foundational types that all resource handlers will use.\n\n## Types to Define\n\n### FileFormat enum\n```rust\npub enum FileFormat {\n    Json,\n    Jsonc,  // JSON with comments\n    Yaml,\n    Markdown,\n    MarkdownWithFrontmatter,\n}\n```\n\n### DirectoryStructure enum\n```rust\npub enum DirectoryStructure {\n    /// Files directly in directory: commands/foo.md\n    Flat { file_pattern: String },\n    \n    /// Subdirectory per resource: skills/foo/SKILL.md\n    Nested { \n        subdir_pattern: String,\n        file_name: String,\n    },\n}\n```\n\n### DirectoryResource struct\n```rust\npub struct DirectoryResource {\n    pub path: PathBuf,\n    pub exists: bool,\n    pub structure: DirectoryStructure,\n    pub file_format: FileFormat,\n}\n```\n\n### ConfigResource struct\n```rust\npub struct ConfigResource {\n    pub file: PathBuf,\n    pub file_exists: bool,\n    pub key_path: String,  // JSON pointer\n    pub format: FileFormat,\n    pub schema_url: Option\u003cString\u003e,\n}\n```\n\n## Location\nCreate new file: src/types.rs (or expand existing)\n\n## Acceptance Criteria\n- [ ] All types derive Debug, Clone\n- [ ] Serde support for serialization\n- [ ] Doc comments on all public items","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T09:34:05.120042Z","updated_at":"2025-12-26T10:06:55.740172Z","closed_at":"2025-12-26T10:06:55.740172Z","close_reason":"Complete - all types implemented with serde support"}
{"id":"get-harness-s7s","title":"Implement plugins() for OpenCode","description":"Implement plugins directory resource for OpenCode ONLY.\n\n## CRITICAL DISTINCTION\nPlugins are NOT MCP servers! They are completely different:\n- Plugins: JS/TS code extensions that add tools/capabilities\n- MCP: Protocol servers that expose tools via stdin/stdout or HTTP\n\n## Paths\n- Global: ~/.config/opencode/plugin/\n- Project: .opencode/plugin/\n\n## Structure\nEach plugin is a JS/TS file or directory with index.ts\n\n## API\n```rust\n// Only OpenCode has plugins\nfn plugins(\u0026self) -\u003e Option\u003cDirectoryResource\u003e {\n    Some(DirectoryResource {\n        global_path: Some(\"~/.config/opencode/plugin\"),\n        project_path: Some(\".opencode/plugin\"),\n        structure: DirectoryStructure::FlatFiles(\"*.{js,ts}\"),\n    })\n}\n```\n\n## Files\n- src/harness/opencode.rs\n- src/harness/claude_code.rs (return None)\n- src/harness/goose.rs (return None)\n\n## Acceptance Criteria\n- [ ] Implement for OpenCode\n- [ ] Return None for Claude Code\n- [ ] Return None for Goose\n- [ ] Unit test","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-26T09:38:28.595832Z","updated_at":"2025-12-26T09:38:28.595832Z","dependencies":[{"issue_id":"get-harness-s7s","depends_on_id":"get-harness-gye","type":"blocks","created_at":"2025-12-26T09:40:43.754718Z","created_by":"daemon"}]}
{"id":"get-harness-v69","title":"Update tests for new Harness API","description":"## Context\nPhase 3 of Harness API refactor. Updates all tests to use new API.\n\n## Key Changes\n- `src/harness/mod.rs` (tests) - Remove/update tests using old `*_path()` methods\n- `src/harness/mod.rs` (tests) - Add tests for `HarnessKind::ALL`\n- `src/harness/mod.rs` (tests) - Add tests for `new()`, `is_installed()`, `installed()`\n- `src/harness/mod.rs` (tests) - Add tests for `plugins()`, `agents()` returning None for non-OpenCode\n\n## Patterns to Follow\n- Use early-return pattern: `if !is_installed() { return; }`\n- Test both `Ok(None)` and `Ok(Some(_))` cases\n- Check `DirectoryStructure` and `FileFormat` in resource tests\n\n## Success Criteria\n- [ ] `cargo test` passes (all tests)\n- [ ] `cargo clippy --all-targets -- -D warnings` clean\n- [ ] No dead code warnings\n- [ ] Coverage for all new methods\n\n## References\n- Full plan: `.beads/artifacts/get-harness-gye/plan.md` (Phase 3 section)\n- Existing test patterns: `src/harness/mod.rs:106-311`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T11:17:50.680311Z","updated_at":"2025-12-26T12:02:00.793353Z","closed_at":"2025-12-26T12:02:00.793353Z","close_reason":"Tests already added during Phase 2 implementation. All 81 tests pass, clippy clean.","dependencies":[{"issue_id":"get-harness-v69","depends_on_id":"get-harness-d6a","type":"blocks","created_at":"2025-12-26T11:17:59.793211Z","created_by":"daemon"}]}
{"id":"get-harness-vvg","title":"Define MCP normalized types","description":"Define the normalized MCP server types that work across all harnesses.\n\n## McpServer Enum\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\n#[serde(tag = \"transport\", rename_all = \"snake_case\")]\npub enum McpServer {\n    Stdio(StdioMcpServer),\n    Sse(SseMcpServer),\n    Http(HttpMcpServer),\n}\n```\n\n## StdioMcpServer\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct StdioMcpServer {\n    pub command: String,\n    #[serde(default, skip_serializing_if = \"Vec::is_empty\")]\n    pub args: Vec\u003cString\u003e,\n    #[serde(default, skip_serializing_if = \"HashMap::is_empty\")]\n    pub env: HashMap\u003cString, EnvValue\u003e,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub cwd: Option\u003cPathBuf\u003e,\n    #[serde(default = \"default_true\")]\n    pub enabled: bool,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub timeout_ms: Option\u003cu64\u003e,\n}\n```\n\n## SseMcpServer (for SSE transport)\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct SseMcpServer {\n    pub url: String,\n    #[serde(default, skip_serializing_if = \"HashMap::is_empty\")]\n    pub headers: HashMap\u003cString, EnvValue\u003e,\n    #[serde(default = \"default_true\")]\n    pub enabled: bool,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub timeout_ms: Option\u003cu64\u003e,\n}\n```\n\n## HttpMcpServer (for Streamable HTTP transport)\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct HttpMcpServer {\n    pub url: String,\n    #[serde(default, skip_serializing_if = \"HashMap::is_empty\")]\n    pub headers: HashMap\u003cString, EnvValue\u003e,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub oauth: Option\u003cOAuthConfig\u003e,\n    #[serde(default = \"default_true\")]\n    pub enabled: bool,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub timeout_ms: Option\u003cu64\u003e,\n}\n```\n\n## OAuthConfig\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct OAuthConfig {\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub client_id: Option\u003cString\u003e,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub client_secret: Option\u003cEnvValue\u003e,\n    #[serde(default, skip_serializing_if = \"Option::is_none\")]\n    pub scope: Option\u003cString\u003e,\n}\n```\n\n## Location\nCreate new file: src/mcp.rs\n\n## Acceptance Criteria\n- [ ] All types derive Debug, Clone, Serialize, Deserialize\n- [ ] Serde annotations for clean JSON output\n- [ ] Doc comments explaining each field\n- [ ] Unit tests for serialization/deserialization","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T09:34:42.843514Z","updated_at":"2025-12-26T10:54:27.383034Z","closed_at":"2025-12-26T10:54:27.383034Z","close_reason":"Complete - all requirements verified, tests passing","dependencies":[{"issue_id":"get-harness-vvg","depends_on_id":"get-harness-6or","type":"blocks","created_at":"2025-12-26T09:40:31.291784Z","created_by":"daemon"}]}
